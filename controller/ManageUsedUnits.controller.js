/*
 * Copyright (C) 2009-2022 SAP SE or an SAP affiliate company. All rights reserved.
 */
sap.ui.define(["fin/cash/bankmaster/manage/util/BaseController","fin/cash/bankmaster/manage/util/Navigator","fin/cash/bankmaster/manage/util/Formatter"],function(B,N,F){"use strict";return B.extend("fin.cash.bankmaster.manage.controller.ManageUsedUnits",{formatter:F,onInit:function(e){this.getRouter().attachRoutePatternMatched(this.onRoutePatternMatched,this);this.oCrossAppNavigator=sap.ushell&&sap.ushell.Container&&sap.ushell.Container.getService("CrossApplicationNavigation");},onRoutePatternMatched:function(e){if(e.getParameter("name")!=="ManageUsedUnitsScreen")return;this.bankContextPath=e.getParameter("arguments").bankContextPath;var t=this.getText("MANAGE_USED_UNITS_SCREEN_TITLE");this.getOwnerComponent().getService("ShellUIService").then(function(s){s.setTitle(t);},function(E){jQuery.sap.log.error("Cannot get ShellUIService",E,"fin.cash.bankmaster.manage.Component");});this.byId("_IDEGen_fragment0--fin.cash.bankmaster.manage.usedUnitSmartResponsiveTable").setTableBindingPath("/"+this.bankContextPath+"/BankToUsedBpSet");this.byId("_IDEGen_fragment1--fin.cash.bankmaster.manage.usedCompanySmartResponsiveTable").setTableBindingPath("/"+this.bankContextPath+"/BankToUsedCompanySet");this.bankCountry=this.bankContextPath.match(/BankCountry='(\S*)',/)[1];this.bankInternalId=this.bankContextPath.match(/BankInternalId='(\S*)'/)[1];if(this.usedUnitIsInitialized){this.byId("_IDEGen_fragment0--fin.cash.bankmaster.manage.usedUnitSmartResponsiveTable").rebindTable();}if(this.usedUnitIsInitialized){this.byId("_IDEGen_fragment1--fin.cash.bankmaster.manage.usedCompanySmartResponsiveTable").rebindTable();}},onUsedUnitSmartTableInitialized:function(){this.usedUnitIsInitialized=true;this.byId("_IDEGen_fragment0--fin.cash.bankmaster.manage.usedUnitSmartResponsiveTable").rebindTable();},onUsedCompanySmartTableInitialized:function(){this.usedUnitIsInitialized=true;this.byId("_IDEGen_fragment1--fin.cash.bankmaster.manage.usedCompanySmartResponsiveTable").rebindTable();},onBeforeRebindUsedBusinessPartnerTable:function(e){var b=e.getParameter("bindingParams");var o=this.getView().getModel().createEntry("/UsedBpSet").getProperty();for(var i in o){if(i!=="__metadata"){if(b.parameters.select){b.parameters.select+=","+i;}else{b.parameters.select=i;}}}b.parameters["countMode"]="Inline";this._filterTable(e);},onBeforeRebindUsedCompanyTable:function(e){var b=e.getParameter("bindingParams");var o=this.getView().getModel().createEntry("/UsedCompanySet").getProperty();for(var i in o){if(i!=="__metadata"){if(b.parameters.select){b.parameters.select+=","+i;}else{b.parameters.select=i;}}}b.parameters["countMode"]="Inline";this._filterTable(e);},onUsedBusinessPartnerListItemPressed:function(e){var b=e.getSource().getBindingContext().getObject().BpNumber;if(b){if(this.oCrossAppNavigator){this.oCrossAppNavigator.toExternal({target:{semanticObject:"BusinessPartner",action:"manage"},params:{"BusinessPartnerForEdit":b}});}}},_filterTable:function(e){if(this.bankCountry&&this.bankInternalId){var f=new sap.ui.model.Filter("BankCountry","EQ",this.bankCountry);var b=decodeURIComponent(this.bankInternalId);var o=new sap.ui.model.Filter("BankInternalId","EQ",b);var a=[f,o];e.getParameter("bindingParams").filters.push(new sap.ui.model.Filter(a,true));}},});});
