/*
 * Copyright (C) 2009-2022 SAP SE or an SAP affiliate company. All rights reserved.
 */
sap.ui.define(["fin/cash/bankmaster/manage/util/BaseController","fin/cash/bankmaster/manage/util/Creator","fin/cash/bankmaster/manage/util/Updater","fin/cash/bankmaster/manage/util/Deleter","fin/cash/bankmaster/manage/util/Navigator","fin/cash/bankmaster/manage/util/Messager","fin/cash/bankmaster/manage/util/Validator","fin/cash/bankmaster/manage/util/Formatter","sap/fin/central/lib/library","sap/ui/model/json/JSONModel"],function(B,C,U,D,N,M,V,F,a,J){"use strict";return B.extend("fin.cash.bankmaster.manage.controller.Bank",{formatter:F,onInit:function(e){this.getRouter().attachRoutePatternMatched(this.onRoutePatternMatched,this);this.version=this.getOwnerComponent()._version;var v=new J();var o={version:this.version,mode:"read",hasUsedUnitCount:false};v.setData(o);this.getView().setModel(v,"viewMode");V._initMessagePopover(this);this.validatedFields=V._initValidatedFields();this.byId("messagesIndicator").setVisible(false);this.byId("BankViewObjectPageLayout").setShowFooter(false);this.oCrossAppNavigator=sap.ushell&&sap.ushell.Container&&sap.ushell.Container.getService("CrossApplicationNavigation");var O=this.byId("BankViewObjectPageLayout");var t=this;if(!this.version||this.version!=="basic"){O.attachEvent("subSectionEnteredViewPort",function(e){var s=e.getParameter("subSection");var S=s.getId();if(S.endsWith("relatedBranchSubSection")){t._refreshTable("_IDEGen_fragment3--fin.cash.bankmaster.manage.RelatedBranchesSmartResponsiveTable");}if(S.endsWith("serviceSubSection")){t._refreshTable("_IDEGen_fragment4--fin.cash.bankmaster.manage.bankfeeservicesmarttable");}if(S.endsWith("defaultableBPSubSection")){t._refreshTable("defaultBPTableFragment--fin.cash.bankmaster.manage.defaultableBPsmarttable");}if(S.endsWith("historySubSection")){t._refreshTable("_IDEGen_fragment5--fin.cash.bankmaster.historySmartResponsiveTable");}});}},onRoutePatternMatched:function(e){if(e.getParameter("name")!=="BankScreen")return;this.getView().getModel().setDefaultBindingMode("TwoWay");var t=this.getText("BANK_SEL_TITLE");this.getOwnerComponent().getService("ShellUIService").then(function(s){s.setTitle(t);},function(E){jQuery.sap.log.error("Cannot get ShellUIService",E,"fin.cash.bankmaster.manage.Component");});var m=e.getParameter("arguments").mode.toLowerCase();this.getView().getModel("viewMode").setProperty("/mode",m);this.bankContextPath=e.getParameter("arguments").bankContextPath;var b=e.getParameter("arguments").bankInternalId;if(b.indexOf(" ")!==-1){this.bankContextPath=this.bankContextPath.replace(/ /g,"%20");this.bankContextPath=encodeURIComponent(this.bankContextPath);}var p=e.getParameter("arguments").previousView;var c=this;if(this.oCrossAppNavigator){var n=this.oCrossAppNavigator.isNavigationSupported([{target:{semanticObject:"BankAccount",action:"manageMasterData"}},{target:{semanticObject:"BusinessPartner",action:"manage"}}]).done(function(r){if(r){c.bNavigateToAcctSupported=r[0].supported;c.bNavigateToBPSupported=r[1].supported;if(m==="create"){c.byId("fin.cash.bankmaster.manage.displayButton").setVisible(false);}else{c.byId("fin.cash.bankmaster.manage.displayButton").setVisible(r[0].supported);}c.byId("_IDEGen_fragment2--maintainContactPersonButton").setVisible(r[1].supported);if(!r[1].supported){c.byId("_IDEGen_fragment2--_IDEGen_columnlistitem0").setType("Inactive");}else{c.byId("_IDEGen_fragment2--_IDEGen_columnlistitem0").setType("Navigation");}}else{c.bNavigateToAcctSupported=false;c.bNavigateToBPSupported=false;c.byId("_IDEGen_fragment2--_IDEGen_columnlistitem0").setType("Inactive");c.byId("fin.cash.bankmaster.manage.displayButton").setVisible(false);c.byId("_IDEGen_fragment2--maintainContactPersonButton").setVisible(false);}});}if(m==="create"){this.byId("BankViewObjectPageLayout").setShowFooter(true);c.getView().getModel().metadataLoaded().then(function(){c.bankContext=c.getView().getModel().createEntry("/BankSet",{});c.getView().setBindingContext(c.bankContext);});}else{c.getView().getModel().read("/"+c.bankContextPath,{success:function(d,r){c.bankCountry=d.BankCountry;c.bankInternalId=encodeURIComponent(d.BankInternalId);c.bpNumber=d.BpNumber;if(p!=="createBank"&&d.Hasattachment){var A=a.environ.AttachmentService.getAttachmentServiceName();c.byId("fin.cash.bankmaster.manage.bankUploadCollectionSection").setVisible(true);var f=c.getOwnerComponent();if(f._oComp===null){var g=c.bankContextPath;var h="BUS1011";f._oComp=sap.ui.getCore().createComponent({name:A,id:"attachmentsrv.cash",settings:{mode:"D",objectKey:g,objectType:h}});c.byId("attachmentServiceFile").setComponent(f._oComp);}else{f._oComp.refresh(f._oComp.getMode(),f._oComp.getObjectType(),c.bankContextPath);}var i=f._oComp.getAttributes();var u=c._prepareAttrList(i);f._oComp.setAttributes(u);}else{c.byId("fin.cash.bankmaster.manage.bankUploadCollectionSection").setVisible(false);}}});this.bankContext=new sap.ui.model.Context(this.getView().getModel(),"/"+this.bankContextPath);this.bankCountry=this.bankContextPath.match(/BankCountry='(\S*)',/)[1];this.bankInternalId=b;if(!this.version||this.version!=="basic"){if(c.byId("_IDEGen_fragment1--fin.cash.bankmaster.manage.houseBankSmartResponsiveTable")){c.byId("_IDEGen_fragment1--fin.cash.bankmaster.manage.houseBankSmartResponsiveTable").rebindTable();}if(c.byId("_IDEGen_fragment2--fin.cash.bankmaster.manage.contactSmartResponsiveTable")){c.byId("_IDEGen_fragment2--fin.cash.bankmaster.manage.contactSmartResponsiveTable").rebindTable();}}if(m==="edit")this._toggleEditAndDisplay(true);else this._toggleEditAndDisplay(false);}if(m!=="create"){this.getView().setBindingContext(this.bankContext);}if(m!=="create"){if(this.version!=="basic"){this.getUsedUnitCount();}}var o=this.byId("BankViewObjectPageLayout");o._triggerVisibleSubSectionsEvents();},_refreshTable:function(t){var T=this.byId(t).getTableBindingPath();if(T.indexOf(this.bankContextPath)===-1){this.byId(t).rebindTable();}},onContactTableInitialized:function(){this.contactTableInitialized=true;if(this.contactTableInitialized&&this.houseBankTableInitial){this.byId("_IDEGen_fragment1--fin.cash.bankmaster.manage.houseBankSmartResponsiveTable").rebindTable();this.byId("_IDEGen_fragment2--fin.cash.bankmaster.manage.contactSmartResponsiveTable").rebindTable();}},onHouseBankTableInitialized:function(){this.houseBankTableInitial=true;if(this.contactTableInitialized&&this.houseBankTableInitial){this.byId("_IDEGen_fragment1--fin.cash.bankmaster.manage.houseBankSmartResponsiveTable").rebindTable();this.byId("_IDEGen_fragment2--fin.cash.bankmaster.manage.contactSmartResponsiveTable").rebindTable();}},_prepareAttrList:function(l){l._VisibleAttributes.UPLOADEDBY=true;l._VisibleAttributes.UPLOADEDON=true;l._VisibleAttributes.FILESIZE=true;l._VisibleAttributes.ENABLELINK=true;l._VisibleActions.RENAME=false;l._VisibleActions.DELETE=true;l._VisibleActions.ADD=true;return l;},onMetadataLoaded:function(){this.bankContext=this.getView().getModel().createEntry("/BankSet",{});this.getView().setBindingContext(this.bankContext);},getUsedUnitCount:function(){this.byId("_IDEGen_fragment0--usedUnitCountField").setText("");var u;var t=this;this.getView().getModel().read(t.getView().getBindingContext().getPath()+"/BankToCountInfoSet",{success:function(d,r){if(r.data.results.length>0){t.getView().getModel("viewMode").setProperty("/hasUsedUnitCount",true);u=r.data.results[0].UsedUnitCount;t.byId("_IDEGen_fragment0--usedUnitCountField").setText(u);}else{t.getView().getModel("viewMode").setProperty("/hasUsedUnitCount",false);}}});},_toggleEditAndDisplay:function(s){if(this.bNavigateToAcctSupported&&!s){this.byId("fin.cash.bankmaster.manage.displayButton").setVisible(!s);}else{this.byId("fin.cash.bankmaster.manage.displayButton").setVisible(false);}this.byId("BankViewObjectPageLayout").setShowFooter(s);},onUsedUnitLinkPressed:function(e){var b=e.getSource().getBindingContext().getPath().substr(1);var c=this.getView().getModel().oData[b].BankCountry;var d=this.getView().getModel().oData[b].BankInternalId;if(!c||!d)return;this.getRouter().navTo("ManageUsedUnitsScreen",{bankContextPath:"BankSet(BankCountry='"+c+"',BankInternalId='"+encodeURIComponent(d)+"')"},false);},onSaveButtonPressed:function(){this.dataObject=this.getView().getBindingContext().getObject();if(this.getView().byId("_IDEGen_fragment0--bankNameField").getValueState()==="Error"){return;}this.saveSuccess=false;this.validatedMessages=[];var i=3;var n=true;n=V._setNonEmptyValidation(this,"_IDEGen_fragment0--bankCountryField",this.getText("NON_EMPTY_VALIDATION_BANK_COUNTRY_TITLE"))&&n;n=V._setNonEmptyValidation(this,"_IDEGen_fragment0--bankNameField",this.getText("NON_EMPTY_VALIDATION_BANK_NAME_TITLE"))&&n;n=V._setLimitLength(this,"_IDEGen_fragment0--ratingSelect",this.getText("NON_EMPTY_VALIDATION_RATING_SELECTION_TITLE"),i)&&n;if(n===false){this.pressMode=" ";return;}var t=this;if(this.getView().getModel("viewMode").getProperty("/mode")==="create"){if(this.getView().byId("_IDEGen_fragment0--bankKeyField").getValue()===""&&this.dataObject.BankInternalId!==""){this.dataObject.BankInternalId=this.getView().byId("_IDEGen_fragment0--bankKeyField").getValue();}this.byId("fin.cash.bankmaster.manage.saveButton").setEnabled(false);this.byId("fin.cash.bankmaster.manage.saveButton").setText(this.getText("SAVING_BUTTON"));$.when(C._createData(this,"/BankSet",this.getText("CREATE_BANK_SUCCESS_TEXT"),this.getText("CREATE_BANK_ERROR_TEXT"))).then(function(r){if(r){t.byId("fin.cash.bankmaster.manage.saveButton").setEnabled(true);t.byId("fin.cash.bankmaster.manage.saveButton").setText(t.getText("SAVE_BUTTON"));if(t.saveSuccess===true){t.refresh.bankTable=true;if(t.pressMode!=="back"){t.getRouter().navTo("BankScreen",{mode:"read",bankContextPath:"BankSet(BankCountry='"+t.getView().getBindingContext().getProperty("BankCountry")+"',BankInternalId='"+encodeURIComponent(t.bankInternalId)+"')",bankInternalId:encodeURIComponent(t.bankInternalId),previousView:"createBank"},true);}t.pressMode=" ";}else{t.pressMode=" ";}}});}else{$.when(U._updateData(this,this.getText("UPDATE_BANK_SUCCESS_TEXT"),this.getText("UPDATE_BANK_ERROR_TEXT"),{"filterParams":["BankToAddressSet","BankToHouseBankSet","BankToBpContactSet","BankToUsedCompanySet","BankToUsedBpSet","BankToChangeDocumentSet","BanktoRelatedBranchesSet"]})).then(function(r){if(r){t.byId("fin.cash.bankmaster.manage.saveButton").setEnabled(true);t.byId("fin.cash.bankmaster.manage.saveButton").setText(t.getText("SAVE_BUTTON"));if(t.saveSuccess===true){t._toggleEditAndDisplay(false);t.getView().getModel("viewMode").setProperty("/mode","read");}else{t._toggleEditAndDisplay(true);}t.refreshBinding(t);}});}t.byId("_IDEGen_fragment5--fin.cash.bankmaster.historySmartResponsiveTable").rebindTable();},onDeletionMarkChanged:function(e){this.validatedMessages=[];if(this.getView().getBindingContext().getObject().HasHouseBanks==="YES"&&this.getView().getBindingContext().getObject().DeletionMark==="X"){V._setValidationMessage(this,"deletionMarkField","Error",this.getText("MARK_AS_DELETED_HOUSE_BANKS_EXIST_TITLE"));this.byId("deletionMarkField").getModel().resetChanges();}else if(this.getView().getBindingContext().getObject().DeletionMark==="X"){if(this.getView().getBindingContext().getObject().HasBankAccounts==="YES"){var t=this;sap.m.MessageBox.confirm(t.getText("MARK_AS_DELETED_BANK_ACCOUNTS_EXIST_TEXT"),{actions:[sap.m.MessageBox.Action.YES,sap.m.MessageBox.Action.NO],onClose:function(A){if(A==="NO"){t.byId("deletionMarkField").getModel().resetChanges();}}});}}},onMessagePopoverPressed:function(){this.byId("messagesIndicator").setVisible(true);this.byId("BankViewObjectPageLayout").setShowFooter(true);this.byId("messagesIndicator").setText(this.validatedMessages.length);this.messagePopover.openBy(this.byId("messagesIndicator"));},onBackButtonPressed:function(){this.pressMode="back";M._pressBackButton(this);},onCancelButtonPressed:function(){M._pressCancelButton(this);},onEditButtonPressed:function(){this.getView().getModel("viewMode").setProperty("/mode","edit");this._toggleEditAndDisplay(true);if(this.bankContext.getProperty().NameOfBankKey==="1")this.byId("_IDEGen_fragment0--bankNumberField").setEditable(false);},onBeforeRebindHouseBankTable:function(e){var b=e.getParameter("bindingParams");if(this.getView().getModel("viewMode").getProperty("/mode")==="create"||this.version==="basic"){b.preventTableBind=true;return;}this.byId("_IDEGen_fragment1--fin.cash.bankmaster.manage.houseBankSmartResponsiveTable").setTableBindingPath("/"+this.bankContextPath+"/BankToHouseBankSet");var s=b.parameters.select;if(s&&s.indexOf("CompanyCode")!==-1&&s.indexOf("CompanyName")===-1){b.parameters.select=b.parameters.select+=","+"CompanyName";}b.sorter.push(new sap.ui.model.Sorter("CompanyCode",false,false));b.parameters["countMode"]="Inline";this._filterTable(e);},onBeforeRebindContactTable:function(e){var b=e.getParameter("bindingParams");if(this.getView().getModel("viewMode").getProperty("/mode")==="create"||this.version==="basic"){b.preventTableBind=true;return;}this.byId("_IDEGen_fragment2--fin.cash.bankmaster.manage.contactSmartResponsiveTable").setTableBindingPath("/"+this.bankContextPath+"/BankToBpContactSet");b.sorter.push(new sap.ui.model.Sorter("LastName",false,false));b.parameters["countMode"]="Inline";this._filterTable(e);},onBeforeRebindServiceCodeTable:function(e){var b=e.getParameter("bindingParams");if(this.getView().getModel("viewMode").getProperty("/mode")==="create"||this.version==="basic"){b.preventTableBind=true;return;}this.byId("_IDEGen_fragment4--fin.cash.bankmaster.manage.bankfeeservicesmarttable").setTableBindingPath("/"+this.bankContextPath+"/BankToBankServiceSet");b.parameters["countMode"]="Inline";this._filterTable(e);},onBeforeRebindHistoryTable:function(e){var b=e.getParameter("bindingParams");if(this.getView().getModel("viewMode").getProperty("/mode")==="create"||this.version==="basic"){b.preventTableBind=true;return;}this.byId("_IDEGen_fragment5--fin.cash.bankmaster.historySmartResponsiveTable").setTableBindingPath("/"+this.bankContextPath+"/BankToChangeDocumentSet");b.sorter.push(new sap.ui.model.Sorter("ChangeDate",true,false));b.sorter.push(new sap.ui.model.Sorter("ChangeTime",true,false));b.parameters["countMode"]="Inline";this._filterTable(e);},_filterTable:function(e){if(this.bankCountry&&this.bankInternalId){var f=new sap.ui.model.Filter("BankCountry","EQ",this.bankCountry);var b=decodeURIComponent(this.bankInternalId);var o=new sap.ui.model.Filter("BankInternalId","EQ",b);var c=[f,o];e.getParameter("bindingParams").filters.push(new sap.ui.model.Filter(c,true));}},onDisplayButtonPressed:function(e){var b=e.getSource().getBindingContext().getPath().substr(1);var c=b.match(/BankCountry='(\S*)',/);var d=decodeURIComponent(b.match(/BankInternalId='(\S*)'/)[1]);if(c&&d){if(this.oCrossAppNavigator){this.oCrossAppNavigator.toExternal({target:{semanticObject:"BankAccount",action:"manageMasterData"},params:{BankCountry:c[1],Bank:d,BankAccountStatus:["02","09","10"]}});}}},onBpNumberFieldChanged:function(e){this.byId("fin.cash.bankmaster.manage.contactSmartResponsiveTable").rebindTable();},onAdvancedAddressLinkPressed:function(e){if(this.bankContext.getProperty("AddressId")){this.getRouter().navTo("AddressScreen",{mode:this.getView().getModel("viewMode").getProperty("/mode"),bankContextPath:this.bankContextPath,addressContextPath:"AddressSet(AddressId='"+this.bankContext.getProperty("AddressId")+"',Nation='')"},false);}else{this.getRouter().navTo("AddressScreen",{mode:"create",bankContextPath:this.bankContextPath,addressContextPath:"CreateEntitySet"},false);}},onAddHouseBankIconPressed:function(e){this.getRouter().navTo("HouseBankScreen",{mode:"create",bankContextPath:this.bankContextPath,houseBankContextPath:"CreateEntitySet"},false);},onHouseBankListItemPressed:function(e){this.getRouter().navTo("HouseBankScreen",{mode:this.getView().getModel("viewMode").getProperty("/mode"),bankContextPath:this.bankContextPath,houseBankContextPath:e.getSource().getBindingContext().getPath().substr(1)},false);},onDeleteHouseBankIconPressed:function(e){var s=this.byId("_IDEGen_fragment1--fin.cash.bankmaster.manage.houseBankSmartResponsiveTable").getTable().getSelectedItems();this.validatedMessages=[];var t=this;if(s.length===0){sap.m.MessageBox.warning(this.getText("DELETE_UNSELECTED_HOUSE_BANK"));}else{sap.m.MessageBox.confirm(t.getText("DELETE_SELECTED_HOUSE_BANK_TEXT"),{actions:[sap.m.MessageBox.Action.DELETE,sap.m.MessageBox.Action.CANCEL],onClose:function(A){if(A==="DELETE"){for(var i in s){$.when(D._deleteData(t,s[i].getBindingContextPath(),t.getText("DELETE_HOUSE_BANK_SUCCESS_TEXT"),t.getText("DELETE_HOUSE_BANK_ERROR_TEXT"))).then(function(r){if(r&&s.length-1==i){t.byId("_IDEGen_fragment5--fin.cash.bankmaster.historySmartResponsiveTable").rebindTable();t.byId("_IDEGen_fragment1--fin.cash.bankmaster.manage.houseBankSmartResponsiveTable").rebindTable();}});}}}});}},onContactListItemPressed:function(e){if(this.oCrossAppNavigator){this.oCrossAppNavigator.toExternal({target:{semanticObject:"BusinessPartner",action:"manage"},params:{"BusinessPartnerForEdit":e.getSource().getBindingContext().getObject().ContactPersonNumber}});}},onMaintainContactPersonPressed:function(){var b=this.getView().getBindingContext().getObject();if(b.BpNumber){if(this.oCrossAppNavigator){this.oCrossAppNavigator.toExternal({target:{semanticObject:"BusinessPartner",action:"manage"},params:{"BusinessPartnerGrouping":b.BpGroup,"BusinessPartnerForEdit":b.BpNumber}});}}else{sap.m.MessageBox.error(this.getText("NO_BP_MAINTAINED_BEFORE_MAINTAIN_CONTACTS"));}},onMarkButtonPressed:function(e){this.dataObject=this.getView().getBindingContext().getObject();this.saveSuccess=false;this.validatedMessages=[];var t=this;if(this.dataObject.HasHouseBanks==="YES"&&this.dataObject.DeletionMark===""){V._setValidationMessage(this,"_IDEGen_fragment0--deletionMarkField","Error",this.getText("MARK_AS_DELETED_HOUSE_BANKS_EXIST_TITLE"));}else if(this.dataObject.DeletionMark===""){if(this.dataObject.HasBankAccounts==="YES"){sap.m.MessageBox.confirm(t.getText("MARK_AS_DELETED_BANK_ACCOUNTS_EXIST_TEXT"),{actions:[sap.m.MessageBox.Action.YES,sap.m.MessageBox.Action.NO],onClose:function(A){if(A==="YES"){t.dataObject.DeletionMark="X";$.when(U._updateData(t,t.getText("MARK_AS_DELETE_SUCCESS_TEXT"),t.getText("MARK_AS_DELETE_ERROR_TEXT"))).then(function(r){if(r){t.byId("_IDEGen_fragment5--fin.cash.bankmaster.historySmartResponsiveTable").rebindTable();t.byId("fin.cash.bankmaster.manage.editButton").setEnabled(false);t.refreshBinding(t);}});}}});}else{this.dataObject.DeletionMark="X";$.when(U._updateData(this,this.getText("MARK_AS_DELETE_SUCCESS_TEXT"),this.getText("MARK_AS_DELETE_ERROR_TEXT"))).then(function(r){if(r){t.byId("fin.cash.bankmaster.manage.editButton").setEnabled(false);t.byId("_IDEGen_fragment5--fin.cash.bankmaster.historySmartResponsiveTable").rebindTable();t.refreshBinding(t);}});}}else if(this.dataObject.DeletionMark==="X"){this.dataObject.DeletionMark="";$.when(U._updateData(this,this.getText("UNMARK_AS_DELETE_SUCCESS_TEXT"),this.getText("UNMARK_AS_DELETE_ERROR_TEXT"))).then(function(r){if(r){t.byId("fin.cash.bankmaster.manage.editButton").setEnabled(true);t.byId("_IDEGen_fragment5--fin.cash.bankmaster.historySmartResponsiveTable").rebindTable();t.refreshBinding(t);}});}},onBeforeRebindRelatedBranchesTable:function(e){var b=e.getParameter("bindingParams");if(this.getView().getModel("viewMode").getProperty("/mode")==="create"||this.version==="basic"){b.preventTableBind=true;return;}this.byId("_IDEGen_fragment3--fin.cash.bankmaster.manage.RelatedBranchesSmartResponsiveTable").setTableBindingPath("/"+this.bankContextPath+"/BanktoRelatedBranchesSet");b.sorter.push(new sap.ui.model.Sorter("BankName",false,false));b.parameters["countMode"]="Inline";this._filterTable(e);},onAddExsitingBanksPressed:function(e){if(this.bpNumber){this.getRouter().navTo("selectExistingBanksScreen",{bpNumber:this.bpNumber,bankCountry:this.bankCountry,bankInternalId:this.bankInternalId},false);}},onDeleteExsitingBanksPressed:function(e){var s=this.byId("_IDEGen_fragment3--fin.cash.bankmaster.manage.RelatedBranchesSmartResponsiveTable").getTable().getSelectedItems();this.validatedMessages=[];var t=this;if(s.length===0){sap.m.MessageBox.warning(this.getText("DELETE_UNSELECTED_RELATED_BRANCHES"));}else{sap.m.MessageBox.confirm(this.getText("DELETE_SELECTED_RELATED_BRANCHES_TEXT"),{actions:[sap.m.MessageBox.Action.DELETE,sap.m.MessageBox.Action.CANCEL],onClose:function(A){if(A==="DELETE"){for(var i in s){$.when(D._deleteData(t,s[i].getBindingContextPath(),t.getText("DELETE_RELATED_BRANCHES_SUCCESS_TEXT"),t.getText("DELETE_RELATED_BRANCHES_ERROR_TEXT"))).then(function(r){if(r&&s.length-1==i){t.byId("_IDEGen_fragment3--fin.cash.bankmaster.manage.RelatedBranchesSmartResponsiveTable").rebindTable();}});}}}});}},onAddServiceCodeIconPressed:function(e){this.getRouter().navTo("ServiceMappingScreen",{mode:"create",bankContextPath:this.bankContextPath,serviceCodePath:"CreateEntitySet"},false);},onServiceCodeListItemPressed:function(e){this.getRouter().navTo("ServiceMappingScreen",{mode:this.getView().getModel("viewMode").getProperty("/mode"),bankContextPath:this.bankContextPath,serviceCodePath:e.getSource().getBindingContext().getPath().substr(1)},false);},onDeleteServiceCodeIconPressed:function(e){var s=this.byId("_IDEGen_fragment4--fin.cash.bankmaster.manage.bankfeeservicesmarttable").getTable().getSelectedItems();this.validatedMessages=[];var t=this;if(s.length===0){sap.m.MessageBox.warning(this.getText("DELETE_UNSELECTED_SERVICECODE"));}else{sap.m.MessageBox.confirm(this.getText("DELETE_SELECTED_SERVICECODE_TEXT"),{actions:[sap.m.MessageBox.Action.DELETE,sap.m.MessageBox.Action.CANCEL],onClose:function(A){if(A==="DELETE"){for(var i in s){$.when(D._deleteData(t,s[i].getBindingContextPath(),t.getText("DELETE_SERVICECODE_SUCCESS_TEXT"),t.getText("DELETE_SERVICECODE_ERROR_TEXT"))).then(function(r){if(r&&s.length-1==i){t.byId("_IDEGen_fragment4--fin.cash.bankmaster.manage.bankfeeservicesmarttable").rebindTable();}});}}}});}},onBeforeRebindDefaultableBPTable:function(e){var b=e.getParameter("bindingParams");if(this.getView().getModel("viewMode").getProperty("/mode")==="create"||this.version==="basic"){b.preventTableBind=true;return;}this.byId("defaultBPTableFragment--fin.cash.bankmaster.manage.defaultableBPsmarttable").setTableBindingPath("/"+this.bankContextPath+"/BankToDefaultableBPSet");b.parameters["countMode"]="Inline";this._filterTable(e);},onAddDefaulttableBPIconPressed:function(e){this.getRouter().navTo("DefaultableBPScreen",{mode:"create",bankContextPath:this.bankContextPath,defaultableBPPath:"CreateEntitySet"},false);},onDefaultableBPItemPressed:function(e){this.getRouter().navTo("DefaultableBPScreen",{mode:this.getView().getModel("viewMode").getProperty("/mode"),bankContextPath:this.bankContextPath,defaultableBPPath:e.getSource().getBindingContext().getPath().substr(1)},false);},onBeforeRelatedBankKeyPopoverOpen:function(e){var s=e.getParameters().semanticAttributesOfSemanticObjects;var n={};n.Bank=s.Bank.Bank;n.BankCountry=s.Bank.RelatedBankCountry;e.getParameters().setSemanticAttributes(n,"Bank");e.getParameters().open();}});});
